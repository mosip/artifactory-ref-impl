name: Create Pull request with latest snapshot versions from metadata.xml

on:
  push:
    branches:
      - develop
      - test*

jobs:
  createPullRequest:
    if: ${{ github.head_ref != 'update-patch' }}
    runs-on: ubuntu-latest
    env:
      SERVICE_LOCATION: artifacts/
    steps:
      - uses: actions/checkout@v2
      - name: update versions in Dockerfile
        run: |
          cd "./${{env.SERVICE_LOCATION}}"
          sh ./build_version.sh

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v3
        with:
          token: ${{ secrets.TOKEN }}
          commit-message: updated Dockerfile with latest snapshot jar versions
          title: updated latest jar Url
          body: |
            Jar URL update
            - Contains latest changes for all the jars URL's.
            - Auto-generated by [create-pull-request][1]
          labels: URL update, automated pr
          reviewers: ckm007
          branch: update-patch
